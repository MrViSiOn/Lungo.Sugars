LUNGO.Sugar.GMap=function(a){var d=null,e=[];return{init:function(b){var c=a.dom(b.el);if(c.length>0)d=this.Interface.Map(c[0],b);else console.error("Imposible")},instance:function(){return d},clean:function(){for(var b=0,c=e.length;b<c;b++)e[b].setMap(null);e=[];this.Route.clean()},center:function(b){d.setCenter(this.Interface.LatLng(b))},zoom:function(b){d.setZoom(b)},addMarker:function(b,c,f){if(b){b=new google.maps.Marker({map:d,icon:this.Interface.MarkerIcon(c),animation:google.maps.Animation.DROP,
position:this.Interface.LatLng(b)});f&&b.setAnimation(google.maps.Animation.BOUNCE);e.push(b)}}}}(LUNGO);LUNGO.Sugar.GMap.Interface=function(a){var d={ROADMAP:"roadmap",SATELLITE:"satellite",HYBRID:"hybrid",TERRAIN:"terrain"},e={zoom:12,disableDefaultUI:true,mapTypeId:d.ROADMAP};return{Map:function(b,c){if(c.type)c.mapTypeId=d[c.type];if(c.center)c.center=new google.maps.LatLng(c.center.latitude,c.center.longitude);return new google.maps.Map(b,a.Core.mix(e,c))},LatLng:function(b){return new google.maps.LatLng(b.latitude,b.longitude)},MarkerIcon:function(b){if(b)var c=new google.maps.MarkerImage(b.url,
new google.maps.Size(b.size.x,b.size.y),new google.maps.Point(0,0),new google.maps.Point(b.anchor.x,b.anchor.y));return c||null}}}(LUNGO);LUNGO.Sugar.GMap.Route=function(){var a={service:null,directions:null,route:null,instructions:null,markers:{icons:[],pointers:[]}},d=LUNGO.Sugar.GMap,e=null,b=function(){a.renderer&&a.renderer.setMap(null)};return{init:function(c,f,g,i){e=i||null;a.route=null;a.instructions=null;a.markers.icons=g;a.service=a.service||new google.maps.DirectionsService;a.service.route({origin:d.Interface.LatLng(c),destination:d.Interface.LatLng(f),travelMode:google.maps.TravelMode.DRIVING},function(h,j){if(j==google.maps.DirectionsStatus.OK){a.route=
h;a.instructions=h.routes[0].legs[0];b();a.renderer=new google.maps.DirectionsRenderer({suppressMarkers:a.markers.icons?true:false});a.renderer.setMap(d.instance());a.renderer.setDirections(a.route);if(a.markers.icons){d.addMarker({latitude:a.instructions.start_location.Qa,longitude:a.instructions.start_location.Ra},a.markers.icons.from||null);d.addMarker({latitude:a.instructions.end_location.Qa,longitude:a.instructions.end_location.Ra},a.markers.icons.to||null)}e&&e.apply(e)}})},clean:b,instructions:function(){var c=
{};if(a.instructions){c.distance=a.instructions.distance.text;c.duration=a.instructions.duration.text;var f=[];for(index in a.instructions.steps){var g=a.instructions.steps[index];f.push({distance:g.distance.text,duration:g.duration.text,instructions:g.instructions})}c.steps=f}return c}}}(LUNGO);
